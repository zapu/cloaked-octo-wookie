module.exports =
	_id: "_design/market"
	views:
		sellers_by_pub_keys:
			map: (doc) ->
				if doc.type == 'seller'
					emit doc.pub_key, doc

		work_by_ids:
			map: (doc) ->
				if doc.type == 'work'
					emit doc._id, doc

		work_by_project_ids:
			map: (doc) ->
				if doc.type == 'work'
					emit doc.project_id, doc 

		work_by_project_ids_and_requests:
			map: (doc) ->
				if doc.type == 'work'
					doc.requests.forEach (request) ->
						emit [request.pub_key, doc.project_id], doc

		projects_by_ids:
			map: (doc) ->
				if doc.type == 'project'
					emit doc._id, doc

		projects_with_participants:
			map: (doc) ->
				if doc.type == 'project'
					doc.participants.forEach (participant) ->
						emit [participant, doc._id], doc

		work_unconfirmed_by_project_ids:
			map: (doc) ->
				if doc.type == 'work'
					if doc.confirmations == 0
						emit doc.project_id, doc
