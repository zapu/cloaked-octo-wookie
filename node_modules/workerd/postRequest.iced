request = require 'request'

postRequest = (addr, fields, files, cb) ->
	r = request.post addr, {encoding: null}, (err, res, b) -> cb err, res, b
	form = r.form()
	for key, val of fields
		form.append key, val
	for key, val of files
		form.append key, val.data, filename: val.filename 

module.exports = postRequest